# Created by: Alexander Vereeken <Alexander88207@protonmail.com>
# Maintainer: Alexander Vereeken <Alexander88207@protonmail.com>

if [[ $TODO == *"Installation"* ]]; then

# Download
download https://homura.magzu.net/games/TLauncher-MCL.exe
download https://homura.magzu.net/games/jre-windows.exe
download https://homura.magzu.net/games/Java.7z
download https://ntcore.com/files/4gb_patch.zip

# Prefix
prefix-message
echo -e "\e[40;38;5;32mSet prefix to Windows 10\e[30;48;5;82m\e[0m"
WINEPREFIX=$GDIR/$INST winetricks win10

# Installer
installer-message
info "The following java installation will not complete but thats OK! :)"
WINEPREFIX=$GDIR/$INST wine $DDIR/jre-windows.exe
unzip 4gb_patch.zip
WINEPREFIX=$GDIR/$INST wine $DDIR/4gb_patch.exe "$GDIR/$INST/drive_c/Program Files/Java/jre1.8.0_51/bin/javaw.exe"
mv $DDIR/TLauncher-MCL.exe $GDIR/$INST
rm -r -d -f "$GDIR/$INST/drive_c/Program Files/Java"
cd "$GDIR/$INST/drive_c/Program Files"
7z x $DDIR/Java.7z
mv "$GDIR/$INST/drive_c/Program Files/Java/jre1.8.0_271" "$GDIR/$INST/drive_c/Program Files/Java/jre1.8.0_51"
info "Please know this client is unstable, you maybe need to run it more than one times to get a stable state."
rm $DDIR/jre-windows.exe
rm $DDIR/Java.7z
rm $DDIR/4gb_patch.zip
rm $DDIR/4gb_patch.exe
fi

if [[ $TODO == *"Launcher"* ]]; then
WINEPREFIX=$GDIR/$LNCH wine $GDIR/$LNCH/TLauncher-MCL.exe
fi

if [[ $TODO == *"Uninstallation"* ]]; then
rm -d -r -f "$GDIR/$UNST"
fi
