# Created by: Alexander Vereeken <Alexander88207@protonmail.com>
# Maintainer: Alexander Vereeken <Alexander88207@protonmail.com>

if [[ $TODO == *"Installation"* ]]; then

# Download
mkdir "$NDIR/Games/$INST"
cd "$NDIR/Games/$INST"
download http://dl.clonehero.net/clonehero-v.23.2.2/clonehero-win32.7z

# Prefix
prefix-message
echo -e "\e[40;38;5;32mInstalling arial fonts to fix missing fonts in the controls menu and ingame\e[30;48;5;82m\e[0m"
WINEPREFIX=$NDIR/Games/$INST winetricks arial
echo -e "\e[40;38;5;32mSet prefix to Windows 10\e[30;48;5;82m\e[0m"
WINEPREFIX=$NDIR/Games/$INST winetricks win10

# Installer
installer-message
7z x clonehero-win32.7z
rm clonehero-win32.7z
echo -e "\e[40;38;5;32mApplying a fix to prevent game from crashing at start\e[30;48;5;82m\e[0m"
cd clonehero-win32
fetch https://gitlab.com/Alexander88207/Homura/-/raw/master/Gameconfigs/Clone%20Hero/settings.ini
info "If you own a guitar hero controller, you may want to check out the tutorial how to get this controller working: https://forums.freebsd.org/threads/setting-up-guitar-hero-guitars-for-clone-hero-etc-on-freebsd.72953/"
fi

if [[ $TODO == *"Launcher"* ]]; then
WINEPREFIX="$NDIR/Games/$LNCH" wine "$NDIR/Games/$LNCH/clonehero-win32/Clone Hero.exe"
fi

if [[ $TODO == *"Uninstallation"* ]]; then
rm -d -r "$NDIR/Games/$UNST"
rm "/usr/home/$USER/.local/share/applications/$UNST.desktop"
rm $DDIR/favicon.ico
rm "/usr/home/$USER/.local/share/applications/$CS.desktop"
fi

if [[ $OTR == *"Create a shortcut"* ]]; then
cd $DDIR
fetch https://clonehero.net/favicon.ico
if [ -f "/usr/home/$USER/.local/share/applications/$CS.desktop" ]; then
rm "/usr/home/$USER/.local/share/applications/$CS.desktop"
fi
echo "[Desktop Entry]
Name=$CS
Exec=$NAME Launch '$CS'
Type=Application
StartupNotify=true
Icon=$DDIR/favicon.ico" >> "/usr/home/$USER/.local/share/applications/$CS.desktop"
fi
